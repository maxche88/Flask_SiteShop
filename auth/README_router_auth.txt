Это ядро системы управления пользователями: регистрация, вход/выход, подтверждение email, восстановление пароля и работа с корзиной — всё в одном blueprint’е.
Модуль сочетает REST API (JSON) и традиционные HTML-формы, поддерживает безопасность (валидация, лимиты попыток, JWT) и интегрируется с почтовыми утилитами и базой данных.


1. Регистрация.
Принимает JSON-данные (имя, email, пароль).
Проверяет уникальность имени/email, валидность email.
Создаёт пользователя в неподтверждённом состоянии.
Отправляет письмо с токеном подтверждения email.
Логирует IP-адрес регистрации (через IPAttemptLog).

2. Подтверждение email.
Обрабатывает ссылку с токеном (/confirm-email).
Проверяет валидность и тип токена.
Подтверждает email пользователя в БД.
Поддерживает как HTML-страницы, так и JSON-ответы.

3. Вход (ввод логина и пароля).
Принимает логин (имя/email) и пароль.
Проверяет учётные данные и статус подтверждения email.
При успехе выдаёт JWT-токен доступа.

4. Проверка авторизации.
Эндпоинт /auth возвращает данные текущего пользователя по валидному JWT.
Используется фронтендом для проверки, залогинен ли пользователь.

5. Выход (логаута).
Удаляет cookie access_token.
Перенаправляет на главную страницу.

6. Восстановление пароля.
Запрос ссылки: пользователь вводит email → система проверяет его наличие и отправляет письмо с токеном.
Ограничение попыток: для каждого IP ведётся счётчик попыток восстановления (через IPAttemptLog), чтобы предотвратить спам/брутфорс.
Смена пароля: по токену открывается форма, где пользователь задаёт новый пароль.

7. Работа с корзиной покупок.
GET — отображает корзину (в шаблоне cart.html).
POST — добавляет товар в корзину.
DELETE — удаляет один товар или всю корзину.
Доступен только авторизованным пользователям (@jwt_required()).